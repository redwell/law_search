# プロジェクト仕様書 (PROJECT_SPEC.md)

## ビジョン

一般ユーザーが自然言語で質問して日本の法律を調べられるシステムを構築する。e-GovのXMLデータを活用し、全文検索・ベクトル検索・グラフ検索を組み合わせたハイブリッド検索により、法律に詳しくない一般ユーザーでも直感的に法律情報を取得できることを目指す。

## コア原則

### 1. ユーザー中心設計
- **対象ユーザー**: 法律家ではなく一般ユーザー
- **インターフェース**: 自然言語での質問応答
- **回答形式**: 分かりやすい説明 + 引用元の法律条文

### 2. コスト重視
- **本番環境**: パフォーマンスよりコストコントロールを重視
- **技術選択**: オープンソース・無料ツールを優先
- **運用**: 最小限のリソースで最大の効果

### 3. 段階的開発
- **MVP**: 特定の法律領域（税法）に絞ったWebUI
- **拡張**: 判例・通達の追加、他プラットフォーム連携
- **スケール**: 全法律領域への拡張

### 4. 品質重視
- **開発手法**: t_wada方式のTDD採用
- **コード品質**: black/ruffによる自動フォーマット・リント
- **テスト**: 包括的なテストカバレッジ

## 成功指標

### MVP段階
- **機能指標**
  - 税法関連の質問に対する回答精度: 80%以上
  - 回答生成時間: 5秒以内
  - 引用元の正確性: 95%以上

- **技術指標**
  - システム稼働率: 99%以上
  - データ更新頻度: 月1回
  - レスポンス時間: 平均3秒以内

### 本格運用段階
- **ユーザー指標**
  - 月間アクティブユーザー: 1,000人以上
  - ユーザー満足度: 4.0/5.0以上
  - 質問解決率: 85%以上

- **技術指標**
  - 全法律領域のカバレッジ: 100%
  - データ更新頻度: 週1回
  - システム拡張性: 他プラットフォーム対応

## 非目標

### MVP段階で除外する機能
- **判例データ**: 国税庁の通達・判例は次のステップ
- **他プラットフォーム**: LINE/Teams/Slack/Discord連携は後回し
- **全法律領域**: 最初は税法のみに限定
- **リアルタイム更新**: 定期的なバッチ更新で十分

### 技術的な非目標
- **マルチステージビルド**: シンプルなDockerfileで十分
- **複雑なマイクロサービス**: モノレポ構成で開始
- **高可用性**: コスト重視のため、シンプルな構成

## プロジェクトスコープ

### 含まれる機能
- e-Gov XMLデータの取得・処理
- ArangoDBによるデータ格納・管理
- ハイブリッド検索（全文・ベクトル・グラフ）
- RAG（Retrieval-Augmented Generation）システム
- WebUI（質問応答インターフェース）
- 引用元表示機能

### 含まれない機能（MVP段階）
- 判例・通達データ
- 他プラットフォーム連携
- ユーザー認証・アカウント管理
- 高度な分析・レポート機能
- 多言語対応

## 技術スタック

### データベース
- **ArangoDB**: 全文検索・ベクトル検索・グラフ検索を統合

### AI・機械学習
- **言語モデル**: ChatGPT（将来的に変更の可能性）
- **埋め込みモデル**: jinaai/jina-embeddings-v3
- **RAGフレームワーク**: langchain/langgraph

### 開発環境
- **Python**: uvによるパッケージ管理
- **バージョン管理**: Git + GitHub
- **IDE**: Cursor
- **コンテナ**: Docker + docker-compose
- **CI/CD**: GitHub Actions

### 本番環境
- **クラウド**: AWS または GCP
- **デプロイ**: Dockerコンテナ
- **監視**: 基本的なログ・メトリクス

## リスクと対策

### 技術リスク
- **ArangoDBの学習コスト**: 公式ドキュメントとコミュニティを活用
- **埋め込みモデルの性能**: 複数モデルでの比較検証
- **RAGシステムの複雑性**: 段階的な実装とテスト

### データリスク
- **e-Govデータの変更**: 定期的な監視と自動更新
- **データ品質の問題**: 前処理での品質チェック
- **データ量の増大**: 効率的なインデックス設計

### 運用リスク
- **コストの増大**: 定期的なコスト監視と最適化
- **パフォーマンスの劣化**: 継続的な監視とチューニング
- **セキュリティ**: 基本的なセキュリティ対策の実装

## 次のステップ

1. **技術アーキテクチャの詳細設計**
2. **MVP要件の詳細定義**
3. **開発環境の構築**
4. **プロトタイプの実装**
5. **テスト・評価・改善**

---

*このドキュメントはリビングドキュメントです。プロジェクトの進行に合わせて継続的に更新されます。*
